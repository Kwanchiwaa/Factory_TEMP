<!DOCTYPE html>
<html>
<head>
  <title>Sensor Dashboard</title>
  <script src="https://cdn.socket.io/4.3.2/socket.io.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h2>Real-time Sensor Dashboard</h2>
  <canvas id="temperatureChart"></canvas>
  <canvas id="humidityChart"></canvas>
  <canvas id="pmChart"></canvas>

<script>
  const socket = io();

  // สร้าง Chart
  const tempCtx = document.getElementById('temperatureChart').getContext('2d');
  const tempChart = new Chart(tempCtx, {
    type: 'line',
    data: { labels: [], datasets: [{ label: 'Temperature (°C)', data: [], borderColor: 'red', borderWidth: 2 }] }
  });

  const humCtx = document.getElementById('humidityChart').getContext('2d');
  const humChart = new Chart(humCtx, {
    type: 'line',
    data: { labels: [], datasets: [{ label: 'Humidity (%)', data: [], borderColor: 'blue', borderWidth: 2 }] }
  });

  const pmCtx = document.getElementById('pmChart').getContext('2d');
  const pmChart = new Chart(pmCtx, {
    type: 'line',
    data: { labels: [], datasets: [{ label: 'PM2.5 (ug/m³)', data: [], borderColor: 'green', borderWidth: 2 }] }
  });

  socket.on('sensor_data', function(data) {
    const time = new Date().toLocaleTimeString();
    if (data.topic === 'sensor/temperature') {
      tempChart.data.labels.push(time);
      tempChart.data.datasets[0].data.push(parseFloat(data.value));
      tempChart.update();
    }
    if (data.topic === 'sensor/humidity') {
      humChart.data.labels.push(time);
      humChart.data.datasets[0].data.push(parseFloat(data.value));
      humChart.update();
    }
    if (data.topic === 'sensor/pm25') {
      pmChart.data.labels.push(time);
      pmChart.data.datasets[0].data.push(parseInt(data.value));
      pmChart.update();
    }
  });
</script>
</body>
</html>

    setInterval(updateData, 2000); // Update every 2 seconds
  </script>
</body>
</html>
